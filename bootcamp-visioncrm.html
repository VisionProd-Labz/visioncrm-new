<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VisionCRM Bootcamp - Mission Stagiaire</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    /* === VARIABLES CSS === */
    :root {
      --bg-primary: #1a1a1a;
      --bg-secondary: #2d2d2d;
      --bg-card: #3a3a3a;
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --accent: #ff6b00;
      --accent-light: #ff8533;
      --success: #00c853;
      --warning: #ffc107;
      --metal: #4a4a4a;
      --metal-light: #6a6a6a;
    }

    [data-theme="light"] {
      --bg-primary: #f5f5f5;
      --bg-secondary: #e0e0e0;
      --bg-card: #ffffff;
      --text-primary: #1a1a1a;
      --text-secondary: #666666;
      --metal: #d0d0d0;
      --metal-light: #b0b0b0;
    }

    /* === RESET & BASE === */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      transition: all 0.3s ease;
    }

    /* === LAYOUT === */
    .app-container {
      display: grid;
      grid-template-columns: 280px 1fr;
      grid-template-rows: auto 1fr auto;
      min-height: 100vh;
    }

    @media (max-width: 768px) {
      .app-container {
        grid-template-columns: 1fr;
      }
    }

    /* === HEADER === */
    header {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, var(--bg-secondary), var(--metal));
      padding: 1rem 2rem;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      border-bottom: 3px solid var(--accent);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.5rem;
      font-weight: bold;
    }

    .logo-icon { font-size: 2rem; }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .trainee-input {
      background: var(--bg-card);
      border: 2px solid var(--metal-light);
      color: var(--text-primary);
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-size: 1rem;
    }

    .trainee-input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .theme-toggle {
      background: var(--bg-card);
      border: none;
      padding: 0.5rem;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      transition: transform 0.3s;
    }

    .theme-toggle:hover { transform: rotate(180deg); }

    /* === PROGRESS BAR === */
    .progress-container {
      flex: 1;
      min-width: 200px;
      max-width: 400px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.25rem;
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .progress-bar {
      height: 20px;
      background: var(--metal);
      border-radius: 10px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--success));
      border-radius: 10px;
      transition: width 0.5s ease;
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* === SIDEBAR === */
    .sidebar {
      background: var(--bg-secondary);
      padding: 1.5rem;
      border-right: 2px solid var(--metal);
    }

    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        left: -100%;
        top: 0;
        height: 100vh;
        width: 280px;
        z-index: 1000;
        transition: left 0.3s;
      }
      .sidebar.open { left: 0; }
      .menu-toggle {
        display: block !important;
        position: fixed;
        bottom: 1rem;
        right: 1rem;
        z-index: 1001;
        background: var(--accent);
        border: none;
        padding: 1rem;
        border-radius: 50%;
        font-size: 1.5rem;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      }
    }

    .menu-toggle { display: none; }

    .sidebar-title {
      font-size: 1.25rem;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .level-list { list-style: none; }

    .level-item {
      background: var(--bg-card);
      margin-bottom: 0.75rem;
      padding: 1rem;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .level-item:hover { transform: translateX(5px); }
    .level-item.active { border-color: var(--accent); }
    .level-item.locked { opacity: 0.5; cursor: not-allowed; }
    .level-item.completed { border-color: var(--success); }

    .level-item.completed::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--success);
    }

    .level-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .level-name {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .level-status { font-size: 1.25rem; }

    .level-progress {
      height: 6px;
      background: var(--metal);
      border-radius: 3px;
      overflow: hidden;
    }

    .level-progress-fill {
      height: 100%;
      background: var(--accent);
      transition: width 0.3s;
    }

    .xp-display {
      margin-top: 1.5rem;
      padding: 1rem;
      background: linear-gradient(135deg, var(--accent), var(--accent-light));
      border-radius: 12px;
      text-align: center;
    }

    .xp-label { font-size: 0.875rem; opacity: 0.9; }
    .xp-value { font-size: 2rem; font-weight: bold; }

    /* === MAIN CONTENT === */
    main {
      padding: 2rem;
      overflow-y: auto;
    }

    .week-container {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .week-container.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .week-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .week-icon {
      font-size: 3rem;
      background: linear-gradient(135deg, var(--accent), var(--accent-light));
      padding: 1rem;
      border-radius: 16px;
    }

    .week-title h2 {
      font-size: 1.75rem;
      margin-bottom: 0.25rem;
    }

    .week-title p {
      color: var(--text-secondary);
    }

    /* === ACCORDIONS === */
    .accordion {
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 1rem;
      overflow: hidden;
      border: 1px solid var(--metal);
    }

    .accordion-header {
      padding: 1rem 1.5rem;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--bg-secondary);
      transition: background 0.3s;
    }

    .accordion-header:hover { background: var(--metal); }

    .accordion-title {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 600;
    }

    .accordion-arrow {
      transition: transform 0.3s;
    }

    .accordion.open .accordion-arrow { transform: rotate(180deg); }

    .accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .accordion.open .accordion-content { max-height: 2000px; }

    .accordion-body { padding: 1.5rem; }

    /* === CHECKLIST === */
    .mission-list { list-style: none; }

    .mission-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1rem;
      background: var(--bg-secondary);
      margin-bottom: 0.5rem;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .mission-item:hover { background: var(--metal); }

    .mission-checkbox {
      width: 24px;
      height: 24px;
      cursor: pointer;
      accent-color: var(--accent);
      flex-shrink: 0;
    }

    .mission-text {
      flex: 1;
      transition: all 0.3s;
    }

    .mission-item.completed .mission-text {
      text-decoration: line-through;
      opacity: 0.6;
    }

    .mission-item.completed {
      background: rgba(0, 200, 83, 0.1);
      border-left: 3px solid var(--success);
    }

    /* === REPORT GENERATOR === */
    .report-section {
      margin-top: 2rem;
      padding: 1.5rem;
      background: var(--bg-card);
      border-radius: 12px;
      border: 2px dashed var(--metal-light);
    }

    .report-title {
      font-size: 1.25rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .drop-zone {
      border: 2px dashed var(--accent);
      border-radius: 12px;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 1rem;
    }

    .drop-zone:hover, .drop-zone.dragover {
      background: rgba(255, 107, 0, 0.1);
      border-color: var(--accent-light);
    }

    .drop-zone-icon { font-size: 3rem; margin-bottom: 0.5rem; }

    .screenshot-preview {
      max-width: 100%;
      max-height: 200px;
      border-radius: 8px;
      margin-top: 1rem;
      display: none;
    }

    .tech-select {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .tech-chip {
      background: var(--bg-secondary);
      border: 2px solid var(--metal);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.875rem;
    }

    .tech-chip:hover { border-color: var(--accent); }
    .tech-chip.selected {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    .report-notes {
      width: 100%;
      min-height: 100px;
      background: var(--bg-secondary);
      border: 2px solid var(--metal);
      border-radius: 8px;
      padding: 1rem;
      color: var(--text-primary);
      font-family: inherit;
      resize: vertical;
      margin-bottom: 1rem;
    }

    .report-notes:focus {
      outline: none;
      border-color: var(--accent);
    }

    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn:hover {
      background: var(--accent-light);
      transform: translateY(-2px);
    }

    .btn:active { transform: translateY(0); }

    .btn-secondary {
      background: var(--metal);
    }

    .btn-secondary:hover { background: var(--metal-light); }

    .btn-success { background: var(--success); }

    /* === TABLES === */
    .info-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }

    .info-table th, .info-table td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--metal);
    }

    .info-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      width: 40%;
    }

    .info-table tr:hover { background: var(--bg-secondary); }

    /* === CODE BLOCKS === */
    .code-block {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 1rem;
      border-radius: 8px;
      font-family: 'Consolas', monospace;
      font-size: 0.875rem;
      overflow-x: auto;
      margin: 1rem 0;
    }

    /* === FOOTER === */
    footer {
      grid-column: 1 / -1;
      background: var(--bg-secondary);
      padding: 1rem 2rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      border-top: 2px solid var(--metal);
    }

    .footer-actions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: var(--accent);
      margin-left: 1rem;
      text-decoration: none;
    }

    .footer-links a:hover { text-decoration: underline; }

    /* === CONFETTI === */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      pointer-events: none;
      z-index: 9999;
      animation: confetti-fall 3s ease-out forwards;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    /* === CERTIFICATE MODAL === */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    .modal-overlay.open { display: flex; }

    .modal {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 2rem;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      animation: modalIn 0.3s ease;
    }

    @keyframes modalIn {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .certificate {
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      border: 4px solid var(--accent);
      border-radius: 16px;
      padding: 2rem;
      text-align: center;
    }

    .certificate-title {
      font-size: 2rem;
      color: var(--accent);
      margin-bottom: 1rem;
    }

    .certificate-name {
      font-size: 1.5rem;
      margin: 1rem 0;
    }

    .certificate-badges {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin: 1.5rem 0;
      flex-wrap: wrap;
    }

    .badge {
      background: var(--bg-secondary);
      padding: 1rem;
      border-radius: 12px;
      text-align: center;
      min-width: 80px;
    }

    .badge-icon { font-size: 2rem; }
    .badge-name { font-size: 0.75rem; margin-top: 0.5rem; }

    /* === ACCESSIBILITY === */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border: 0;
    }

    :focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* === ANIMATIONS === */
    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .shake {
      animation: shake 0.5s ease;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
  </style>
</head>
<body>
  <!-- Container principal -->
  <div class="app-container">

    <!-- HEADER -->
    <header role="banner">
      <div class="logo">
        <span class="logo-icon">üöó</span>
        <span>VisionCRM <strong style="color: var(--accent)">Bootcamp</strong></span>
      </div>

      <div class="progress-container">
        <div class="progress-label">
          <span>Progression Globale</span>
          <span id="progress-percent">0%</span>
        </div>
        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
          <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
        </div>
      </div>

      <div class="header-controls">
        <input type="text" class="trainee-input" id="trainee-name" placeholder="Nom du stagiaire" aria-label="Nom du stagiaire">
        <button class="theme-toggle" id="theme-toggle" aria-label="Changer le theme">üåô</button>
      </div>
    </header>

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar" role="navigation" aria-label="Navigation des semaines">
      <h2 class="sidebar-title">‚öôÔ∏è Niveaux</h2>

      <ul class="level-list" id="level-list">
        <li class="level-item active" data-week="1" tabindex="0" role="button" aria-pressed="true">
          <div class="level-header">
            <span class="level-name">üîç Semaine 1</span>
            <span class="level-status" id="status-1">üîì</span>
          </div>
          <div class="level-progress">
            <div class="level-progress-fill" id="progress-1" style="width: 0%"></div>
          </div>
        </li>
        <li class="level-item locked" data-week="2" tabindex="0" role="button" aria-pressed="false">
          <div class="level-header">
            <span class="level-name">üé® Semaine 2</span>
            <span class="level-status" id="status-2">üîí</span>
          </div>
          <div class="level-progress">
            <div class="level-progress-fill" id="progress-2" style="width: 0%"></div>
          </div>
        </li>
        <li class="level-item locked" data-week="3" tabindex="0" role="button" aria-pressed="false">
          <div class="level-header">
            <span class="level-name">üí° Semaine 3</span>
            <span class="level-status" id="status-3">üîí</span>
          </div>
          <div class="level-progress">
            <div class="level-progress-fill" id="progress-3" style="width: 0%"></div>
          </div>
        </li>
        <li class="level-item locked" data-week="4" tabindex="0" role="button" aria-pressed="false">
          <div class="level-header">
            <span class="level-name">üèÜ Semaine 4</span>
            <span class="level-status" id="status-4">üîí</span>
          </div>
          <div class="level-progress">
            <div class="level-progress-fill" id="progress-4" style="width: 0%"></div>
          </div>
        </li>
      </ul>

      <div class="xp-display">
        <div class="xp-label">XP Total</div>
        <div class="xp-value" id="xp-total">0</div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main role="main">

      <!-- ============ SEMAINE 1 ============ -->
      <section class="week-container active" id="week-1" aria-labelledby="week-1-title">
        <div class="week-header">
          <div class="week-icon">üîç</div>
          <div class="week-title">
            <h2 id="week-1-title">Semaine 1 : Decouverte et Prise en Main</h2>
            <p>Installation, exploration et comprehension de l'architecture</p>
          </div>
        </div>

        <!-- Accordion: Contexte Projet -->
        <div class="accordion open">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="true">
            <span class="accordion-title">üìã Contexte du Projet</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <h3>Vision</h3>
              <p>VisionCRM est un CRM (Customer Relationship Management) multi-tenant concu pour les entrepreneurs et PME. L'application permet de gerer les contacts, devis, factures, taches, et inclut un module specifique pour les garages automobiles.</p>

              <h3 style="margin-top: 1rem;">Stack Technologique</h3>
              <table class="info-table">
                <tr><th>Next.js 15</th><td>Framework React avec App Router</td></tr>
                <tr><th>React 19</th><td>Interface utilisateur</td></tr>
                <tr><th>TypeScript</th><td>Typage statique</td></tr>
                <tr><th>PostgreSQL</th><td>Base de donnees relationnelle</td></tr>
                <tr><th>Prisma</th><td>ORM (Object-Relational Mapping)</td></tr>
                <tr><th>Auth.js v5</th><td>Authentification OAuth + credentials</td></tr>
                <tr><th>Tailwind CSS</th><td>Styles utilitaires</td></tr>
                <tr><th>shadcn/ui</th><td>Composants UI</td></tr>
                <tr><th>Vercel</th><td>Hebergement et deploiement</td></tr>
              </table>

              <h3 style="margin-top: 1rem;">Structure du Projet</h3>
              <div class="code-block">
visioncrm/
‚îú‚îÄ‚îÄ app/                    # Routes Next.js (App Router)
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/            # Pages authentification (login, register)
‚îÇ   ‚îú‚îÄ‚îÄ (dashboard)/       # Pages protegees (dashboard, contacts, etc.)
‚îÇ   ‚îî‚îÄ‚îÄ api/               # Routes API REST
‚îú‚îÄ‚îÄ components/            # Composants React reutilisables
‚îú‚îÄ‚îÄ lib/                   # Utilitaires et configuration
‚îú‚îÄ‚îÄ prisma/               # Schema et migrations base de donnees
‚îú‚îÄ‚îÄ contexts/             # Contextes React (langue, theme)
‚îî‚îÄ‚îÄ hooks/                # Hooks React personnalises
              </div>
            </div>
          </div>
        </div>

        <!-- Accordion: Mission 1.1 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">‚öôÔ∏è Mission 1.1 : Installation de l'environnement</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="1-1-1">
                  <input type="checkbox" class="mission-checkbox" id="m1-1-1" aria-label="Installer Node.js, Git, VS Code">
                  <label class="mission-text" for="m1-1-1">Installer Node.js (v18+), Git, VS Code</label>
                </li>
                <li class="mission-item" data-mission="1-1-2">
                  <input type="checkbox" class="mission-checkbox" id="m1-1-2" aria-label="Cloner le repository">
                  <label class="mission-text" for="m1-1-2">Cloner le repository et installer les dependances (<code>pnpm install</code>)</label>
                </li>
                <li class="mission-item" data-mission="1-1-3">
                  <input type="checkbox" class="mission-checkbox" id="m1-1-3" aria-label="Configurer environnement">
                  <label class="mission-text" for="m1-1-3">Configurer les variables d'environnement (<code>.env.local</code>)</label>
                </li>
                <li class="mission-item" data-mission="1-1-4">
                  <input type="checkbox" class="mission-checkbox" id="m1-1-4" aria-label="Lancer le projet">
                  <label class="mission-text" for="m1-1-4">Lancer le projet en local (<code>pnpm dev</code>)</label>
                </li>
                <li class="mission-item" data-mission="1-1-5">
                  <input type="checkbox" class="mission-checkbox" id="m1-1-5" aria-label="Explorer l'application">
                  <label class="mission-text" for="m1-1-5">Explorer l'application en tant qu'utilisateur (login, navigation)</label>
                </li>
              </ul>

              <div class="code-block">
# Commandes d'installation
git clone https://github.com/[repo]/visioncrm.git
cd visioncrm
pnpm install
cp .env.example .env.local
# Editer .env.local avec les vraies valeurs
pnpm dev
              </div>
            </div>
          </div>
        </div>

        <!-- Accordion: Mission 1.2 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">üìñ Mission 1.2 : Etude du code</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="1-2-1">
                  <input type="checkbox" class="mission-checkbox" id="m1-2-1">
                  <label class="mission-text" for="m1-2-1">Lire et comprendre le schema Prisma (<code>prisma/schema.prisma</code>)</label>
                </li>
                <li class="mission-item" data-mission="1-2-2">
                  <input type="checkbox" class="mission-checkbox" id="m1-2-2">
                  <label class="mission-text" for="m1-2-2">Identifier les principaux modeles (Contact, Quote, Invoice, Vehicle)</label>
                </li>
                <li class="mission-item" data-mission="1-2-3">
                  <input type="checkbox" class="mission-checkbox" id="m1-2-3">
                  <label class="mission-text" for="m1-2-3">Comprendre le flux d'authentification (<code>auth.ts</code>, <code>middleware.ts</code>)</label>
                </li>
                <li class="mission-item" data-mission="1-2-4">
                  <input type="checkbox" class="mission-checkbox" id="m1-2-4">
                  <label class="mission-text" for="m1-2-4">Documenter les routes API existantes</label>
                </li>
                <li class="mission-item" data-mission="1-2-5">
                  <input type="checkbox" class="mission-checkbox" id="m1-2-5">
                  <label class="mission-text" for="m1-2-5">Comprendre le multi-tenancy (tenant_id, isolation des donnees)</label>
                </li>
              </ul>

              <h4 style="margin-top: 1rem;">Concepts cles a maitriser</h4>
              <table class="info-table">
                <tr><th>Multi-tenancy</th><td>Chaque client a un <code>tenant_id</code> qui isole ses donnees</td></tr>
                <tr><th>RBAC</th><td>5 roles (SUPER_ADMIN, ADMIN, MANAGER, USER, VIEWER) avec 142+ permissions</td></tr>
                <tr><th>Server Components</th><td>Comprendre <code>'use client'</code> vs Server Components</td></tr>
                <tr><th>API Routes</th><td>Routes REST dans <code>/app/api/</code></td></tr>
              </table>
            </div>
          </div>
        </div>

        <!-- Rapport Semaine 1 -->
        <div class="report-section">
          <h3 class="report-title">üìù Livrable S1 : Document de synthese</h3>

          <div class="drop-zone" id="drop-1" tabindex="0" role="button" aria-label="Zone de depot pour screenshot">
            <div class="drop-zone-icon">üì∏</div>
            <p>Glissez votre screenshot ici ou cliquez pour selectionner</p>
            <input type="file" accept="image/*" style="display: none" id="file-1">
            <img class="screenshot-preview" id="preview-1" alt="Apercu screenshot">
          </div>

          <p style="margin-bottom: 0.5rem; font-weight: 600;">Technologies utilisees :</p>
          <div class="tech-select" id="tech-1">
            <span class="tech-chip" data-tech="Next.js">Next.js</span>
            <span class="tech-chip" data-tech="Prisma">Prisma</span>
            <span class="tech-chip" data-tech="TypeScript">TypeScript</span>
            <span class="tech-chip" data-tech="PostgreSQL">PostgreSQL</span>
            <span class="tech-chip" data-tech="Auth.js">Auth.js</span>
            <span class="tech-chip" data-tech="Tailwind">Tailwind</span>
          </div>

          <textarea class="report-notes" id="notes-1" placeholder="Notes sur votre comprehension de l'architecture, questions, observations..."></textarea>

          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <button class="btn" onclick="generateReport(1)">üìÑ Generer Rapport MD</button>
            <button class="btn btn-secondary" onclick="generateReportPDF(1)">üìë Generer PDF</button>
          </div>
        </div>
      </section>

      <!-- ============ SEMAINE 2 ============ -->
      <section class="week-container" id="week-2" aria-labelledby="week-2-title">
        <div class="week-header">
          <div class="week-icon">üé®</div>
          <div class="week-title">
            <h2 id="week-2-title">Semaine 2 : Corrections et Ameliorations UI</h2>
            <p>Traductions, responsive design et validation des formulaires</p>
          </div>
        </div>

        <!-- Mission 2.1 -->
        <div class="accordion open">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="true">
            <span class="accordion-title">üåç Mission 2.1 : Traductions manquantes</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="2-1-1">
                  <input type="checkbox" class="mission-checkbox" id="m2-1-1">
                  <label class="mission-text" for="m2-1-1">Identifier tous les textes non traduits (hardcodes en francais)</label>
                </li>
                <li class="mission-item" data-mission="2-1-2">
                  <input type="checkbox" class="mission-checkbox" id="m2-1-2">
                  <label class="mission-text" for="m2-1-2">Ajouter les traductions dans <code>/lib/translations/</code></label>
                </li>
                <li class="mission-item" data-mission="2-1-3">
                  <input type="checkbox" class="mission-checkbox" id="m2-1-3">
                  <label class="mission-text" for="m2-1-3">Tester le changement de langue (FR/EN)</label>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Mission 2.2 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">üì± Mission 2.2 : Responsive Design</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="2-2-1">
                  <input type="checkbox" class="mission-checkbox" id="m2-2-1">
                  <label class="mission-text" for="m2-2-1">Tester l'application sur mobile/tablette (Chrome DevTools)</label>
                </li>
                <li class="mission-item" data-mission="2-2-2">
                  <input type="checkbox" class="mission-checkbox" id="m2-2-2">
                  <label class="mission-text" for="m2-2-2">Corriger les problemes d'affichage responsive</label>
                </li>
                <li class="mission-item" data-mission="2-2-3">
                  <input type="checkbox" class="mission-checkbox" id="m2-2-3">
                  <label class="mission-text" for="m2-2-3">Ameliorer le menu mobile si necessaire</label>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Mission 2.3 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">‚úÖ Mission 2.3 : Validation des formulaires</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="2-3-1">
                  <input type="checkbox" class="mission-checkbox" id="m2-3-1">
                  <label class="mission-text" for="m2-3-1">Verifier que tous les formulaires ont une validation cote client</label>
                </li>
                <li class="mission-item" data-mission="2-3-2">
                  <input type="checkbox" class="mission-checkbox" id="m2-3-2">
                  <label class="mission-text" for="m2-3-2">Ajouter des messages d'erreur explicites</label>
                </li>
                <li class="mission-item" data-mission="2-3-3">
                  <input type="checkbox" class="mission-checkbox" id="m2-3-3">
                  <label class="mission-text" for="m2-3-3">Tester les cas limites (champs vides, formats invalides)</label>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Rapport Semaine 2 -->
        <div class="report-section">
          <h3 class="report-title">üìù Livrable S2 : Pull Request GitHub</h3>

          <div class="drop-zone" id="drop-2" tabindex="0">
            <div class="drop-zone-icon">üì∏</div>
            <p>Glissez votre screenshot ici ou cliquez pour selectionner</p>
            <input type="file" accept="image/*" style="display: none" id="file-2">
            <img class="screenshot-preview" id="preview-2" alt="Apercu screenshot">
          </div>

          <p style="margin-bottom: 0.5rem; font-weight: 600;">Technologies utilisees :</p>
          <div class="tech-select" id="tech-2">
            <span class="tech-chip" data-tech="React">React</span>
            <span class="tech-chip" data-tech="Tailwind">Tailwind</span>
            <span class="tech-chip" data-tech="i18n">i18n</span>
            <span class="tech-chip" data-tech="CSS">CSS</span>
            <span class="tech-chip" data-tech="Git">Git</span>
          </div>

          <textarea class="report-notes" id="notes-2" placeholder="Lien vers votre PR, description des corrections effectuees..."></textarea>

          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <button class="btn" onclick="generateReport(2)">üìÑ Generer Rapport MD</button>
            <button class="btn btn-secondary" onclick="generateReportPDF(2)">üìë Generer PDF</button>
          </div>
        </div>
      </section>

      <!-- ============ SEMAINE 3 ============ -->
      <section class="week-container" id="week-3" aria-labelledby="week-3-title">
        <div class="week-header">
          <div class="week-icon">üí°</div>
          <div class="week-title">
            <h2 id="week-3-title">Semaine 3 : Developpement de Fonctionnalites</h2>
            <p>Notifications temps reel et export PDF</p>
          </div>
        </div>

        <!-- Mission 3.1 -->
        <div class="accordion open">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="true">
            <span class="accordion-title">üîî Mission 3.1 : Systeme de Notifications</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="3-1-1">
                  <input type="checkbox" class="mission-checkbox" id="m3-1-1">
                  <label class="mission-text" for="m3-1-1">Creer le modele <code>Notification</code> dans Prisma</label>
                </li>
                <li class="mission-item" data-mission="3-1-2">
                  <input type="checkbox" class="mission-checkbox" id="m3-1-2">
                  <label class="mission-text" for="m3-1-2">Creer l'API CRUD (<code>/api/notifications</code>)</label>
                </li>
                <li class="mission-item" data-mission="3-1-3">
                  <input type="checkbox" class="mission-checkbox" id="m3-1-3">
                  <label class="mission-text" for="m3-1-3">Afficher les notifications en temps reel dans le header</label>
                </li>
                <li class="mission-item" data-mission="3-1-4">
                  <input type="checkbox" class="mission-checkbox" id="m3-1-4">
                  <label class="mission-text" for="m3-1-4">Marquer les notifications comme lues</label>
                </li>
              </ul>

              <div class="code-block">
// Exemple de modele Prisma pour Notification
model Notification {
  id          String   @id @default(cuid())
  tenant_id   String
  user_id     String
  type        String   // 'info', 'success', 'warning', 'error'
  title       String
  message     String
  read        Boolean  @default(false)
  created_at  DateTime @default(now())

  tenant      Tenant   @relation(fields: [tenant_id], references: [id])
  user        User     @relation(fields: [user_id], references: [id])
}
              </div>
            </div>
          </div>
        </div>

        <!-- Mission 3.2 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">üìÑ Mission 3.2 : Export PDF des Devis/Factures</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="3-2-1">
                  <input type="checkbox" class="mission-checkbox" id="m3-2-1">
                  <label class="mission-text" for="m3-2-1">Integrer une librairie PDF (react-pdf ou jspdf)</label>
                </li>
                <li class="mission-item" data-mission="3-2-2">
                  <input type="checkbox" class="mission-checkbox" id="m3-2-2">
                  <label class="mission-text" for="m3-2-2">Creer un template de devis professionnel</label>
                </li>
                <li class="mission-item" data-mission="3-2-3">
                  <input type="checkbox" class="mission-checkbox" id="m3-2-3">
                  <label class="mission-text" for="m3-2-3">Ajouter le bouton "Exporter PDF" sur les pages devis/factures</label>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Rapport Semaine 3 -->
        <div class="report-section">
          <h3 class="report-title">üìù Livrable S3 : Fonctionnalites testees et documentees</h3>

          <div class="drop-zone" id="drop-3" tabindex="0">
            <div class="drop-zone-icon">üì∏</div>
            <p>Glissez votre screenshot ici ou cliquez pour selectionner</p>
            <input type="file" accept="image/*" style="display: none" id="file-3">
            <img class="screenshot-preview" id="preview-3" alt="Apercu screenshot">
          </div>

          <p style="margin-bottom: 0.5rem; font-weight: 600;">Technologies utilisees :</p>
          <div class="tech-select" id="tech-3">
            <span class="tech-chip" data-tech="Prisma">Prisma</span>
            <span class="tech-chip" data-tech="API Routes">API Routes</span>
            <span class="tech-chip" data-tech="jsPDF">jsPDF</span>
            <span class="tech-chip" data-tech="React">React</span>
            <span class="tech-chip" data-tech="TypeScript">TypeScript</span>
          </div>

          <textarea class="report-notes" id="notes-3" placeholder="Description des fonctionnalites implementees, problemes rencontres, solutions..."></textarea>

          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <button class="btn" onclick="generateReport(3)">üìÑ Generer Rapport MD</button>
            <button class="btn btn-secondary" onclick="generateReportPDF(3)">üìë Generer PDF</button>
          </div>
        </div>
      </section>

      <!-- ============ SEMAINE 4 ============ -->
      <section class="week-container" id="week-4" aria-labelledby="week-4-title">
        <div class="week-header">
          <div class="week-icon">üèÜ</div>
          <div class="week-title">
            <h2 id="week-4-title">Semaine 4 : Tests et Documentation</h2>
            <p>Qualite du code, tests et presentation finale</p>
          </div>
        </div>

        <!-- Mission 4.1 -->
        <div class="accordion open">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="true">
            <span class="accordion-title">üß™ Mission 4.1 : Tests unitaires</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="4-1-1">
                  <input type="checkbox" class="mission-checkbox" id="m4-1-1">
                  <label class="mission-text" for="m4-1-1">Installer Jest et React Testing Library</label>
                </li>
                <li class="mission-item" data-mission="4-1-2">
                  <input type="checkbox" class="mission-checkbox" id="m4-1-2">
                  <label class="mission-text" for="m4-1-2">Ecrire des tests pour les utilitaires (<code>/lib/</code>)</label>
                </li>
                <li class="mission-item" data-mission="4-1-3">
                  <input type="checkbox" class="mission-checkbox" id="m4-1-3">
                  <label class="mission-text" for="m4-1-3">Ecrire des tests pour les composants critiques</label>
                </li>
                <li class="mission-item" data-mission="4-1-4">
                  <input type="checkbox" class="mission-checkbox" id="m4-1-4">
                  <label class="mission-text" for="m4-1-4">Viser une couverture de code > 50%</label>
                </li>
              </ul>

              <div class="code-block">
// Exemple de test Jest
import { formatCurrency } from '@/lib/utils';

describe('formatCurrency', () => {
  it('should format euros correctly', () => {
    expect(formatCurrency(1234.56)).toBe('1 234,56 ‚Ç¨');
  });

  it('should handle zero', () => {
    expect(formatCurrency(0)).toBe('0,00 ‚Ç¨');
  });
});
              </div>
            </div>
          </div>
        </div>

        <!-- Mission 4.2 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">üìö Mission 4.2 : Documentation technique</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="4-2-1">
                  <input type="checkbox" class="mission-checkbox" id="m4-2-1">
                  <label class="mission-text" for="m4-2-1">Documenter les API avec des exemples</label>
                </li>
                <li class="mission-item" data-mission="4-2-2">
                  <input type="checkbox" class="mission-checkbox" id="m4-2-2">
                  <label class="mission-text" for="m4-2-2">Creer un guide de contribution (CONTRIBUTING.md)</label>
                </li>
                <li class="mission-item" data-mission="4-2-3">
                  <input type="checkbox" class="mission-checkbox" id="m4-2-3">
                  <label class="mission-text" for="m4-2-3">Documenter les procedures de deploiement</label>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Mission 4.3 -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">üé§ Mission 4.3 : Presentation finale</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <ul class="mission-list">
                <li class="mission-item" data-mission="4-3-1">
                  <input type="checkbox" class="mission-checkbox" id="m4-3-1">
                  <label class="mission-text" for="m4-3-1">Preparer une demo des fonctionnalites developpees</label>
                </li>
                <li class="mission-item" data-mission="4-3-2">
                  <input type="checkbox" class="mission-checkbox" id="m4-3-2">
                  <label class="mission-text" for="m4-3-2">Rediger un rapport de stage</label>
                </li>
                <li class="mission-item" data-mission="4-3-3">
                  <input type="checkbox" class="mission-checkbox" id="m4-3-3">
                  <label class="mission-text" for="m4-3-3">Presentation orale (15-20 min)</label>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Criteres d'evaluation -->
        <div class="accordion">
          <div class="accordion-header" tabindex="0" role="button" aria-expanded="false">
            <span class="accordion-title">üìä Criteres d'evaluation</span>
            <span class="accordion-arrow">‚ñº</span>
          </div>
          <div class="accordion-content">
            <div class="accordion-body">
              <table class="info-table">
                <tr><th>Qualite du code</th><td>25% - Lisibilite, conventions</td></tr>
                <tr><th>Respect des delais</th><td>25% - Livrables dans les temps</td></tr>
                <tr><th>Autonomie</th><td>20% - Prise d'initiative</td></tr>
                <tr><th>Communication</th><td>15% - Travail d'equipe</td></tr>
                <tr><th>Documentation</th><td>15% - Qualite des docs</td></tr>
              </table>
            </div>
          </div>
        </div>

        <!-- Rapport Semaine 4 -->
        <div class="report-section">
          <h3 class="report-title">üìù Livrable S4 : Rapport final + Presentation</h3>

          <div class="drop-zone" id="drop-4" tabindex="0">
            <div class="drop-zone-icon">üì∏</div>
            <p>Glissez votre screenshot ici ou cliquez pour selectionner</p>
            <input type="file" accept="image/*" style="display: none" id="file-4">
            <img class="screenshot-preview" id="preview-4" alt="Apercu screenshot">
          </div>

          <p style="margin-bottom: 0.5rem; font-weight: 600;">Technologies utilisees :</p>
          <div class="tech-select" id="tech-4">
            <span class="tech-chip" data-tech="Jest">Jest</span>
            <span class="tech-chip" data-tech="Testing Library">Testing Library</span>
            <span class="tech-chip" data-tech="Markdown">Markdown</span>
            <span class="tech-chip" data-tech="Git">Git</span>
          </div>

          <textarea class="report-notes" id="notes-4" placeholder="Resume de votre stage, apprentissages, perspectives..."></textarea>

          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <button class="btn" onclick="generateReport(4)">üìÑ Generer Rapport MD</button>
            <button class="btn btn-secondary" onclick="generateReportPDF(4)">üìë Generer PDF</button>
            <button class="btn btn-success" onclick="showCertificate()">üèÜ Obtenir Certificat</button>
          </div>
        </div>
      </section>

    </main>

    <!-- FOOTER -->
    <footer role="contentinfo">
      <div class="footer-actions">
        <button class="btn btn-secondary" onclick="saveProgress()">üíæ Sauvegarder</button>
        <button class="btn btn-secondary" onclick="resetProgress()">üîÑ Reset</button>
        <button class="btn btn-secondary" onclick="exportAllReports()">üì¶ Exporter Tout</button>
      </div>

      <div class="footer-links">
        <strong>Ressources :</strong>
        <a href="https://nextjs.org/docs" target="_blank" rel="noopener">Next.js</a>
        <a href="https://www.prisma.io/docs" target="_blank" rel="noopener">Prisma</a>
        <a href="https://tailwindcss.com/docs" target="_blank" rel="noopener">Tailwind</a>
        <a href="https://ui.shadcn.com" target="_blank" rel="noopener">shadcn/ui</a>
      </div>
    </footer>
  </div>

  <!-- Menu Toggle Mobile -->
  <button class="menu-toggle" id="menu-toggle" aria-label="Ouvrir le menu">‚ò∞</button>

  <!-- Modal Certificat -->
  <div class="modal-overlay" id="certificate-modal" role="dialog" aria-modal="true" aria-labelledby="cert-title">
    <div class="modal">
      <div class="certificate" id="certificate-content">
        <div style="font-size: 3rem; margin-bottom: 1rem;">üèÜ</div>
        <h2 class="certificate-title" id="cert-title">CERTIFICAT DE COMPLETION</h2>
        <p style="color: var(--text-secondary);">Ce certificat atteste que</p>
        <p class="certificate-name" id="cert-name">[Nom du Stagiaire]</p>
        <p style="color: var(--text-secondary);">a complete avec succes le</p>
        <p style="font-size: 1.25rem; color: var(--accent); font-weight: bold;">BOOTCAMP VISIONCRM</p>
        <p style="color: var(--text-secondary); margin-top: 0.5rem;">Formation developpement CRM multi-tenant</p>

        <div class="certificate-badges">
          <div class="badge">
            <div class="badge-icon">üîç</div>
            <div class="badge-name">Explorateur</div>
          </div>
          <div class="badge">
            <div class="badge-icon">üé®</div>
            <div class="badge-name">Designer</div>
          </div>
          <div class="badge">
            <div class="badge-icon">üí°</div>
            <div class="badge-name">Developpeur</div>
          </div>
          <div class="badge">
            <div class="badge-icon">üèÜ</div>
            <div class="badge-name">Expert</div>
          </div>
        </div>

        <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 1rem;">
          Date : <span id="cert-date"></span>
        </p>
        <p style="font-size: 0.875rem; color: var(--text-secondary);">
          XP Total : <span id="cert-xp"></span> points
        </p>
      </div>

      <div style="margin-top: 1.5rem; display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
        <button class="btn" onclick="downloadCertificate()">üì• Telecharger PDF</button>
        <button class="btn btn-secondary" onclick="closeCertificate()">Fermer</button>
      </div>
    </div>
  </div>

  <script>
    // === DONNEES ET ETAT ===
    const state = {
      traineeName: '',
      currentWeek: 1,
      unlockedWeeks: [1],
      missions: {},
      screenshots: {},
      techSelected: {},
      notes: {},
      xp: 0
    };

    // Missions par semaine (pour calculer la progression)
    const missionsPerWeek = {
      1: ['1-1-1', '1-1-2', '1-1-3', '1-1-4', '1-1-5', '1-2-1', '1-2-2', '1-2-3', '1-2-4', '1-2-5'],
      2: ['2-1-1', '2-1-2', '2-1-3', '2-2-1', '2-2-2', '2-2-3', '2-3-1', '2-3-2', '2-3-3'],
      3: ['3-1-1', '3-1-2', '3-1-3', '3-1-4', '3-2-1', '3-2-2', '3-2-3'],
      4: ['4-1-1', '4-1-2', '4-1-3', '4-1-4', '4-2-1', '4-2-2', '4-2-3', '4-3-1', '4-3-2', '4-3-3']
    };

    // === INITIALISATION ===
    document.addEventListener('DOMContentLoaded', () => {
      loadProgress();
      initEventListeners();
      updateUI();
    });

    // === EVENT LISTENERS ===
    function initEventListeners() {
      // Theme toggle
      document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

      // Nom stagiaire
      document.getElementById('trainee-name').addEventListener('input', (e) => {
        state.traineeName = e.target.value;
        saveProgress();
      });

      // Navigation semaines
      document.querySelectorAll('.level-item').forEach(item => {
        item.addEventListener('click', () => {
          const week = parseInt(item.dataset.week);
          if (state.unlockedWeeks.includes(week)) {
            switchWeek(week);
          } else {
            item.classList.add('shake');
            setTimeout(() => item.classList.remove('shake'), 500);
            playSound('error');
          }
        });

        item.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            item.click();
          }
        });
      });

      // Accordions
      document.querySelectorAll('.accordion-header').forEach(header => {
        header.addEventListener('click', () => {
          const accordion = header.parentElement;
          accordion.classList.toggle('open');
        });

        header.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            header.click();
          }
        });
      });

      // Checkboxes missions
      document.querySelectorAll('.mission-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
          const missionItem = e.target.closest('.mission-item');
          const missionId = missionItem.dataset.mission;

          state.missions[missionId] = e.target.checked;
          missionItem.classList.toggle('completed', e.target.checked);

          if (e.target.checked) {
            createConfetti(e.target);
            playSound('success');
          }

          updateProgress();
          saveProgress();
        });
      });

      // Tech chips
      document.querySelectorAll('.tech-chip').forEach(chip => {
        chip.addEventListener('click', () => {
          chip.classList.toggle('selected');
          const week = chip.closest('.report-section').querySelector('.drop-zone').id.split('-')[1];

          if (!state.techSelected[week]) state.techSelected[week] = [];
          const tech = chip.dataset.tech;

          if (chip.classList.contains('selected')) {
            if (!state.techSelected[week].includes(tech)) {
              state.techSelected[week].push(tech);
            }
          } else {
            state.techSelected[week] = state.techSelected[week].filter(t => t !== tech);
          }
          saveProgress();
        });
      });

      // Drop zones
      for (let i = 1; i <= 4; i++) {
        const dropZone = document.getElementById(`drop-${i}`);
        const fileInput = document.getElementById(`file-${i}`);

        dropZone.addEventListener('click', () => fileInput.click());

        dropZone.addEventListener('dragover', (e) => {
          e.preventDefault();
          dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
          dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
          e.preventDefault();
          dropZone.classList.remove('dragover');
          const file = e.dataTransfer.files[0];
          if (file && file.type.startsWith('image/')) {
            handleFileUpload(i, file);
          }
        });

        fileInput.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (file) {
            handleFileUpload(i, file);
          }
        });
      }

      // Notes textareas
      for (let i = 1; i <= 4; i++) {
        document.getElementById(`notes-${i}`).addEventListener('input', (e) => {
          state.notes[i] = e.target.value;
          saveProgress();
        });
      }

      // Menu mobile
      document.getElementById('menu-toggle').addEventListener('click', () => {
        document.getElementById('sidebar').classList.toggle('open');
      });

      // Fermer modal certificat
      document.getElementById('certificate-modal').addEventListener('click', (e) => {
        if (e.target === e.currentTarget) {
          closeCertificate();
        }
      });
    }

    // === FONCTIONS PRINCIPALES ===
    function switchWeek(week) {
      state.currentWeek = week;

      // Mise a jour UI navigation
      document.querySelectorAll('.level-item').forEach(item => {
        item.classList.remove('active');
        item.setAttribute('aria-pressed', 'false');
      });
      document.querySelector(`.level-item[data-week="${week}"]`).classList.add('active');
      document.querySelector(`.level-item[data-week="${week}"]`).setAttribute('aria-pressed', 'true');

      // Mise a jour contenu
      document.querySelectorAll('.week-container').forEach(container => {
        container.classList.remove('active');
      });
      document.getElementById(`week-${week}`).classList.add('active');

      saveProgress();
    }

    function updateProgress() {
      let totalCompleted = 0;
      let totalMissions = 0;

      for (let week = 1; week <= 4; week++) {
        const weekMissions = missionsPerWeek[week];
        const completedInWeek = weekMissions.filter(m => state.missions[m]).length;
        const weekProgress = (completedInWeek / weekMissions.length) * 100;

        // Mise a jour barre de progression semaine
        document.getElementById(`progress-${week}`).style.width = `${weekProgress}%`;

        // Verifier si semaine complete
        if (weekProgress === 100) {
          document.getElementById(`status-${week}`).textContent = '‚úÖ';
          document.querySelector(`.level-item[data-week="${week}"]`).classList.add('completed');

          // Debloquer semaine suivante
          if (week < 4 && !state.unlockedWeeks.includes(week + 1)) {
            state.unlockedWeeks.push(week + 1);
            document.querySelector(`.level-item[data-week="${week + 1}"]`).classList.remove('locked');
            document.getElementById(`status-${week + 1}`).textContent = 'üîì';

            // Animation de deblocage
            playSound('unlock');
            createConfettiBurst();
          }
        }

        totalCompleted += completedInWeek;
        totalMissions += weekMissions.length;
      }

      // Progression globale
      const globalProgress = Math.round((totalCompleted / totalMissions) * 100);
      document.getElementById('progress-percent').textContent = `${globalProgress}%`;
      document.getElementById('progress-fill').style.width = `${globalProgress}%`;

      // XP
      state.xp = totalCompleted * 10;
      document.getElementById('xp-total').textContent = state.xp;
    }

    function updateUI() {
      // Nom stagiaire
      document.getElementById('trainee-name').value = state.traineeName;

      // Semaines debloquees
      state.unlockedWeeks.forEach(week => {
        document.querySelector(`.level-item[data-week="${week}"]`).classList.remove('locked');
        document.getElementById(`status-${week}`).textContent = 'üîì';
      });

      // Missions cochees
      Object.entries(state.missions).forEach(([missionId, completed]) => {
        const checkbox = document.querySelector(`.mission-item[data-mission="${missionId}"] .mission-checkbox`);
        if (checkbox) {
          checkbox.checked = completed;
          checkbox.closest('.mission-item').classList.toggle('completed', completed);
        }
      });

      // Screenshots
      Object.entries(state.screenshots).forEach(([week, data]) => {
        const preview = document.getElementById(`preview-${week}`);
        if (preview && data) {
          preview.src = data;
          preview.style.display = 'block';
        }
      });

      // Tech selectionnees
      Object.entries(state.techSelected).forEach(([week, techs]) => {
        techs.forEach(tech => {
          const chip = document.querySelector(`#tech-${week} .tech-chip[data-tech="${tech}"]`);
          if (chip) chip.classList.add('selected');
        });
      });

      // Notes
      Object.entries(state.notes).forEach(([week, notes]) => {
        const textarea = document.getElementById(`notes-${week}`);
        if (textarea) textarea.value = notes;
      });

      // Semaine active
      switchWeek(state.currentWeek);

      // Mise a jour progression
      updateProgress();

      // Theme
      if (localStorage.getItem('theme') === 'light') {
        document.body.setAttribute('data-theme', 'light');
        document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
      }
    }

    // === GESTION FICHIERS ===
    function handleFileUpload(week, file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        state.screenshots[week] = e.target.result;
        const preview = document.getElementById(`preview-${week}`);
        preview.src = e.target.result;
        preview.style.display = 'block';
        saveProgress();
        playSound('success');
      };
      reader.readAsDataURL(file);
    }

    // === GENERATION RAPPORTS ===
    function generateReport(week) {
      const traineeName = state.traineeName || 'Stagiaire';
      const date = new Date().toLocaleDateString('fr-FR');
      const techs = state.techSelected[week] || [];
      const notes = state.notes[week] || '';
      const weekMissions = missionsPerWeek[week];
      const completedMissions = weekMissions.filter(m => state.missions[m]).length;

      const weekTitles = {
        1: 'Decouverte et Prise en Main',
        2: 'Corrections et Ameliorations UI',
        3: 'Developpement de Fonctionnalites',
        4: 'Tests et Documentation'
      };

      const markdown = `# Rapport Mission - Semaine ${week}
## ${weekTitles[week]}

**Stagiaire:** ${traineeName}
**Date:** ${date}
**Progression:** ${completedMissions}/${weekMissions.length} missions (${Math.round(completedMissions/weekMissions.length*100)}%)

---

## Technologies Utilisees
${techs.length > 0 ? techs.map(t => `- ${t}`).join('\n') : '- Aucune selectionnee'}

---

## Notes et Observations
${notes || 'Aucune note ajoutee.'}

---

## Statut
${completedMissions === weekMissions.length ? '‚úÖ Semaine Completee' : '‚è≥ En cours'}

---

*Genere par VisionCRM Bootcamp*
`;

      downloadFile(`rapport-semaine-${week}.md`, markdown, 'text/markdown');
      playSound('success');
    }

    function generateReportPDF(week) {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const traineeName = state.traineeName || 'Stagiaire';
      const date = new Date().toLocaleDateString('fr-FR');
      const techs = state.techSelected[week] || [];
      const notes = state.notes[week] || '';
      const weekMissions = missionsPerWeek[week];
      const completedMissions = weekMissions.filter(m => state.missions[m]).length;

      const weekTitles = {
        1: 'Decouverte et Prise en Main',
        2: 'Corrections et Ameliorations UI',
        3: 'Developpement de Fonctionnalites',
        4: 'Tests et Documentation'
      };

      // Header
      doc.setFillColor(255, 107, 0);
      doc.rect(0, 0, 210, 40, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(24);
      doc.text('VisionCRM Bootcamp', 105, 20, { align: 'center' });
      doc.setFontSize(14);
      doc.text(`Rapport Semaine ${week}`, 105, 32, { align: 'center' });

      // Corps
      doc.setTextColor(0, 0, 0);
      let y = 55;

      doc.setFontSize(18);
      doc.text(weekTitles[week], 20, y);
      y += 15;

      doc.setFontSize(12);
      doc.text(`Stagiaire: ${traineeName}`, 20, y);
      y += 8;
      doc.text(`Date: ${date}`, 20, y);
      y += 8;
      doc.text(`Progression: ${completedMissions}/${weekMissions.length} missions (${Math.round(completedMissions/weekMissions.length*100)}%)`, 20, y);
      y += 15;

      doc.setFontSize(14);
      doc.text('Technologies Utilisees:', 20, y);
      y += 8;
      doc.setFontSize(11);
      if (techs.length > 0) {
        techs.forEach(tech => {
          doc.text(`‚Ä¢ ${tech}`, 25, y);
          y += 6;
        });
      } else {
        doc.text('Aucune selectionnee', 25, y);
        y += 6;
      }
      y += 10;

      doc.setFontSize(14);
      doc.text('Notes et Observations:', 20, y);
      y += 8;
      doc.setFontSize(11);

      const splitNotes = doc.splitTextToSize(notes || 'Aucune note ajoutee.', 170);
      doc.text(splitNotes, 20, y);
      y += splitNotes.length * 6 + 15;

      // Screenshot si presente
      if (state.screenshots[week]) {
        doc.setFontSize(14);
        doc.text('Capture d\'ecran:', 20, y);
        y += 5;
        try {
          doc.addImage(state.screenshots[week], 'JPEG', 20, y, 80, 60);
        } catch (e) {
          console.error('Erreur ajout image:', e);
        }
      }

      // Footer
      doc.setFontSize(10);
      doc.setTextColor(128, 128, 128);
      doc.text('Genere par VisionCRM Bootcamp', 105, 285, { align: 'center' });

      doc.save(`rapport-semaine-${week}.pdf`);
      playSound('success');
    }

    // === CERTIFICAT ===
    function showCertificate() {
      // Verifier que tout est complete
      let allCompleted = true;
      for (let week = 1; week <= 4; week++) {
        const weekMissions = missionsPerWeek[week];
        const completedInWeek = weekMissions.filter(m => state.missions[m]).length;
        if (completedInWeek < weekMissions.length) {
          allCompleted = false;
          break;
        }
      }

      if (!allCompleted) {
        alert('Vous devez completer toutes les missions pour obtenir le certificat!');
        return;
      }

      document.getElementById('cert-name').textContent = state.traineeName || 'Stagiaire';
      document.getElementById('cert-date').textContent = new Date().toLocaleDateString('fr-FR');
      document.getElementById('cert-xp').textContent = state.xp;
      document.getElementById('certificate-modal').classList.add('open');

      createConfettiBurst();
      playSound('unlock');
    }

    function closeCertificate() {
      document.getElementById('certificate-modal').classList.remove('open');
    }

    function downloadCertificate() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('landscape');

      // Background
      doc.setFillColor(26, 26, 26);
      doc.rect(0, 0, 297, 210, 'F');

      // Border
      doc.setDrawColor(255, 107, 0);
      doc.setLineWidth(3);
      doc.rect(10, 10, 277, 190);

      // Inner border
      doc.setDrawColor(100, 100, 100);
      doc.setLineWidth(1);
      doc.rect(15, 15, 267, 180);

      // Title
      doc.setTextColor(255, 107, 0);
      doc.setFontSize(36);
      doc.text('CERTIFICAT DE COMPLETION', 148.5, 50, { align: 'center' });

      // Trophy emoji simulation
      doc.setFontSize(48);
      doc.text('*', 148.5, 75, { align: 'center' });

      // Body text
      doc.setTextColor(200, 200, 200);
      doc.setFontSize(14);
      doc.text('Ce certificat atteste que', 148.5, 95, { align: 'center' });

      doc.setTextColor(255, 255, 255);
      doc.setFontSize(28);
      doc.text(state.traineeName || 'Stagiaire', 148.5, 115, { align: 'center' });

      doc.setTextColor(200, 200, 200);
      doc.setFontSize(14);
      doc.text('a complete avec succes le', 148.5, 130, { align: 'center' });

      doc.setTextColor(255, 107, 0);
      doc.setFontSize(22);
      doc.text('BOOTCAMP VISIONCRM', 148.5, 145, { align: 'center' });

      doc.setTextColor(200, 200, 200);
      doc.setFontSize(12);
      doc.text('Formation developpement CRM multi-tenant', 148.5, 155, { align: 'center' });

      // Badges
      doc.setFontSize(10);
      doc.text('Explorateur | Designer | Developpeur | Expert', 148.5, 170, { align: 'center' });

      // Footer
      doc.setTextColor(150, 150, 150);
      doc.setFontSize(10);
      doc.text(`Date: ${new Date().toLocaleDateString('fr-FR')}`, 60, 185);
      doc.text(`XP Total: ${state.xp} points`, 237, 185);

      doc.save('certificat-visioncrm.pdf');
    }

    // === PERSISTENCE ===
    function saveProgress() {
      localStorage.setItem('visioncrm-bootcamp', JSON.stringify(state));
    }

    function loadProgress() {
      const saved = localStorage.getItem('visioncrm-bootcamp');
      if (saved) {
        Object.assign(state, JSON.parse(saved));
      }
    }

    function resetProgress() {
      if (confirm('Etes-vous sur de vouloir reinitialiser toute la progression?')) {
        localStorage.removeItem('visioncrm-bootcamp');
        location.reload();
      }
    }

    function exportAllReports() {
      for (let i = 1; i <= 4; i++) {
        generateReport(i);
      }
    }

    // === THEME ===
    function toggleTheme() {
      const body = document.body;
      const btn = document.getElementById('theme-toggle');

      if (body.getAttribute('data-theme') === 'light') {
        body.removeAttribute('data-theme');
        btn.textContent = 'üåô';
        localStorage.setItem('theme', 'dark');
      } else {
        body.setAttribute('data-theme', 'light');
        btn.textContent = '‚òÄÔ∏è';
        localStorage.setItem('theme', 'light');
      }
    }

    // === EFFETS ===
    function createConfetti(element) {
      const rect = element.getBoundingClientRect();
      const colors = ['#ff6b00', '#00c853', '#ffc107', '#2196f3', '#e91e63'];

      for (let i = 0; i < 10; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = `${rect.left + rect.width / 2 + (Math.random() - 0.5) * 100}px`;
        confetti.style.top = `${rect.top}px`;
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        document.body.appendChild(confetti);

        setTimeout(() => confetti.remove(), 3000);
      }
    }

    function createConfettiBurst() {
      const colors = ['#ff6b00', '#00c853', '#ffc107', '#2196f3', '#e91e63'];

      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = `${Math.random() * window.innerWidth}px`;
        confetti.style.top = '-10px';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        confetti.style.animationDelay = `${Math.random() * 1}s`;
        document.body.appendChild(confetti);

        setTimeout(() => confetti.remove(), 4000);
      }
    }

    function playSound(type) {
      // Audio API pour sons feedback
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();

      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);

      if (type === 'success') {
        oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
        oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.2);
      } else if (type === 'unlock') {
        oscillator.frequency.setValueAtTime(392, audioContext.currentTime); // G4
        oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime + 0.15); // C5
        oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.3); // E5
        gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
      } else if (type === 'error') {
        oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
      }
    }

    // === UTILITAIRES ===
    function downloadFile(filename, content, type) {
      const blob = new Blob([content], { type });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
